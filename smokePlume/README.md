# Smoke Plume Simulation - OpenFOAM Buoyancy-Driven Flow

## Overview

This OpenFOAM case simulates a buoyant smoke plume rising from a hot inlet in an enclosed domain. The simulation demonstrates buoyancy-driven flow phenomena, similar to smoke rising from a fire or hot gas emissions from industrial stacks. The setup uses the `buoyantPimpleFoam` solver to model the interaction between temperature differences, gravity, and fluid motion. The smoke plume simulation in the `smokePlume` directory is adapted from the [PhiFlow smoke plume example](https://tum-pbs.github.io/PhiFlow/examples/grids/Smoke_Plume.html), reimplemented using OpenFOAM's buoyantPimpleFoam solver.

## Simulation Result

![Smoke Plume Simulation](smokePlume/smoke.mp4)

## Physical Problem Description

### Domain Geometry
- **Size**: 1m × 2m × 0.1m rectangular channel (quasi-2D)
- **Inlet**: Small centered opening at the bottom (0.2m wide, from x=0.4m to x=0.6m)
- **Boundaries**: All walls are closed (no outlet - enclosed domain)
- **Mesh**: High-resolution structured grid (100×160 cells, 16,000 total)

### Physics Modeled
1. **Buoyancy-driven flow**: Hot air (373K/100°C) injected into cooler ambient air (293K/20°C)
2. **Natural convection**: Density differences due to temperature cause upward motion
3. **Flow regime**: Laminar flow (no turbulence modeling for cleaner visualization)
4. **Compressible flow**: Perfect gas equation of state accounts for density variations
5. **Gravity**: -9.81 m/s² in the y-direction

### Key Phenomena Observed
- Buoyant plume rise due to temperature-induced density differences
- Mushroom cloud formation when the plume hits the ceiling
- Lateral spreading and recirculation in the enclosed domain
- Rayleigh-Bénard type instabilities in the rising plume

## File Structure

```
smokePlume/
├── 0/                    # Initial and boundary conditions
│   ├── T                 # Temperature field [K]
│   ├── U                 # Velocity field [m/s]
│   ├── p                 # Pressure field [Pa]
│   ├── p_rgh            # Pressure minus hydrostatic component [Pa]
│   ├── k                # Turbulent kinetic energy [m²/s²] (if using RAS)
│   ├── epsilon          # Turbulent dissipation rate [m²/s³] (if using RAS)
│   ├── alphat           # Turbulent thermal diffusivity [kg/m/s]
│   └── nut              # Turbulent kinematic viscosity [m²/s]
├── constant/            
│   ├── g                # Gravity vector (0 -9.81 0) [m/s²]
│   ├── thermophysicalProperties  # Fluid properties (air as perfect gas)
│   ├── turbulenceProperties      # Turbulence model settings
│   └── polyMesh/        # Mesh files (generated by blockMesh)
├── system/              
│   ├── controlDict      # Time control and output settings
│   ├── fvSchemes        # Numerical discretization schemes
│   ├── fvSolution       # Linear solver settings and pressure reference
│   └── blockMeshDict    # Mesh generation parameters
└── run.sh               # Convenience script to run simulation
```

## Key Parameters to Modify

### 1. Inlet Conditions (`0/U` and `0/T`)
```
# Velocity (0/U)
inlet {
    type            fixedValue;
    value           uniform (0 0.6 0);  # [x, y, z] m/s
}

# Temperature (0/T)
inlet {
    type            fixedValue;
    value           uniform 373;  # Kelvin
}
```
- Increase velocity for stronger plume
- Increase temperature for more buoyancy

### 2. Mesh Resolution (`system/blockMeshDict`)
```
blocks (
    hex (...) (40 160 1) simpleGrading (1 1 1)  # (nx ny nz)
    ...
);
```
- Increase numbers for finer mesh
- Keep nz=1 for 2D simulation

### 3. Turbulence Model (`constant/turbulenceProperties`)
```
simulationType  laminar;  # or RAS for turbulent flow
```
- `laminar`: Clean, smooth plume (good for visualization)
- `RAS` with `kEpsilon`: More realistic turbulent mixing

### 4. Time Control (`system/controlDict`)
```
endTime         10;          # Simulation duration [s]
deltaT          0.0005;      # Initial time step [s]
writeInterval   0.1;         # Output frequency [s]
maxCo           0.3;         # Maximum Courant number
```
- Reduce `maxCo` for more stable simulation
- Reduce `writeInterval` for more output frames

### 5. Numerical Schemes (`system/fvSchemes`)
```
divSchemes {
    div(phi,U)      Gauss linear;         # Central differencing (less diffusive)
    div(phi,h)      Gauss limitedLinear 1; # TVD scheme (more stable)
}
```
- `linear`: Less numerical diffusion, sharper plume
- `limitedLinear` or `linearUpwind`: More stable but diffusive

## Running the Simulation

### Basic Workflow
```bash
# 1. Clean previous results
rm -rf 0.* 1* 2* 3* 4* 5* 6* 7* 8* 9* 10 constant/polyMesh

# 2. Generate mesh
blockMesh

# 3. Check mesh quality
checkMesh

# 4. Run simulation
buoyantPimpleFoam

# 5. Visualize results
paraFoam
```

### Using the Run Script
```bash
./run.sh  # Does all the above automatically
```

## Visualization in ParaView

### Basic Temperature Visualization
1. Launch ParaView: `paraFoam &`
2. Click "Apply" to load the case
3. Select "T" (Temperature) from the dropdown menu
4. Adjust color scale (typically 293-373K)
5. Click play button to animate

### Available Fields for Visualization

#### Primary Fields
- **T (Temperature)** [K]: Shows hot plume rising (293-373K range)
- **U (Velocity)** [m/s]: Vector field showing flow patterns
- **p_rgh (Pressure)** [Pa]: Pressure distribution minus hydrostatic component
- **p (Pressure)** [Pa]: Total pressure field

#### Derived Fields (in ParaView)
- **Velocity Magnitude**: `|U|` - Speed regardless of direction
- **Vorticity**: `curl(U)` - Shows rotational flow structures
- **Density**: Can be calculated from temperature using ideal gas law

### Advanced Visualization Techniques

#### 1. Velocity Vectors
- Filters → Common → Glyph
- Vectors: U
- Glyph Type: Arrow
- Scale Mode: vector

#### 2. Streamlines
- Filters → Common → Stream Tracer
- Vectors: U
- Seed Type: Line or Point Cloud
- Shows flow pathlines

#### 3. Contour Lines (Isotherms)
- Filters → Common → Contour
- Contour By: T
- Add values: 300, 310, 320, 330, 340, 350, 360K
- Shows temperature stratification

#### 4. Volume Rendering
- Change representation to "Volume"
- Adjust opacity transfer function
- Good for 3D visualization of temperature field

#### 5. Animation Export
- File → Save Animation
- Choose format (AVI, PNG sequence)
- Set frame rate and resolution

### Color Maps
Recommended color maps for temperature:
- **Cool to Warm**: Blue (cold) to Red (hot)
- **Black-Body Radiation**: Physically realistic
- **Rainbow**: High contrast but less perceptually uniform

## Troubleshooting

### Common Issues and Solutions

1. **Plume drifts to one side**
   - Natural due to Rayleigh-Bénard instability
   - Check pressure reference cell location in `system/fvSolution`
   - Ensure mesh is symmetric

2. **Too much numerical diffusion**
   - Switch to central differencing schemes
   - Increase mesh resolution
   - Reduce time step (lower maxCo)

3. **Simulation crashes**
   - Reduce inlet velocity
   - Reduce time step
   - Check mesh quality with `checkMesh`
   - Use more stable numerical schemes

4. **Plume too turbulent/chaotic**
   - Switch from RAS to laminar
   - Reduce inlet velocity
   - Increase mesh resolution

## Physics Background

### Governing Equations
The simulation solves the compressible Navier-Stokes equations with buoyancy:
- Continuity equation (mass conservation)
- Momentum equation with gravity term
- Energy equation (temperature transport)
- Equation of state (perfect gas law)

### Key Dimensionless Numbers
- **Rayleigh Number (Ra)**: Ratio of buoyancy to viscous forces
- **Prandtl Number (Pr)**: Ratio of momentum to thermal diffusivity (≈0.7 for air)
- **Richardson Number (Ri)**: Ratio of buoyancy to shear forces

### Physical Parameters (Air at ~60°C)
- Density: ρ = p/(R×T) with R = 287 J/(kg·K)
- Dynamic viscosity: μ = 1.8×10⁻⁵ Pa·s
- Specific heat: Cp = 1007 J/(kg·K)
- Thermal expansion: β = 1/T

## References
- OpenFOAM User Guide: www.openfoam.com
- Buoyant Flows: Turner, J.S. "Buoyancy Effects in Fluids"
- CFD Theory: Versteeg & Malalasekera "An Introduction to Computational Fluid Dynamics"